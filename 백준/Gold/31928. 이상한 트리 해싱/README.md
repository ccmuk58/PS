# [Gold IV] 이상한 트리 해싱 - 31928 

[문제 링크](https://www.acmicpc.net/problem/31928) 

### 성능 요약

메모리: 108384 KB, 시간: 92 ms

### 분류

애드 혹, 해 구성하기

### 제출 일자

2025년 9월 21일 16:03:00

### 문제 설명

<p>트리를 해싱한다면 두 트리가 동형인지 빠르게 확인할 수 있지 않을까?</p>

<p>루트 정점이 존재하는 트리가 있을 때, 트리의 각 정점 $K$의 해시값 $H(K)$는 $K$의 자식 정점 $P_1, P_2, \ldots , P_r$의 해시값 $H(P_1), H(P_2), \ldots , H(P_r)$을 사용하여 다음과 같이 계산된다.</p>

<ul>
	<li>$H(K) = 2 ^ {H(P_1)H(P_2) \dots H(P_r)}$</li>
</ul>

<p>이때, 리프 정점의 해시값은 $2$이다.</p>

<p>양의 정수 $h$가 주어질 때, 루트 정점의 해시값이 $h$이고 서로 동형이 <strong>아닌</strong> 두 트리 $T_1, T_2$를 출력하라.</p>

### 입력 

 <p>첫 번째 줄에 루트 정점이 가져야 할 해시값 $h$가 주어진다. ($1 \le h \le 10^{18}$)</p>

### 출력 

 <p>첫 번째 줄에 $T_1$과 $T_2$의 크기 $n, m$을 공백으로 분리하여 출력한다. ($1 \le n, m \le 100\,000 $)</p>

<p>두 번째 줄에 $T_1$의 $2$번 정점부터 $n$번 정점까지 각 정점의 부모 정점의 번호 $p_2, p_3, \ldots , p_n$을 공백으로 분리하여 출력한다. ($1 \le p_i < i$)</p>

<p>세 번째 줄에 $T_2$의 $2$번 정점부터 $m$번 정점까지 각 정점의 부모 정점의 번호 $q_2, q_3, \ldots , q_m$을 공백으로 분리하여 출력한다. ($1 \le q_i < i$)</p>

<p>$1$번 정점은 루트 정점이다.</p>

<p>서로 동형이 아닌 트리가 여러 쌍 있다면, 그 중 하나를 출력한다.</p>

<p>만약 조건을 만족하는 두 트리가 존재하지 않는다면 첫 번째 줄에 $-1$을 출력한다.</p>

